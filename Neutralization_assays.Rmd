---
title: "Neutralization_assays"
author: "Kenneth Matreyek"
date: "8/13/2020"
output: html_document
---

```{r setup, include=FALSE}
rm(list = ls())
library(tidyverse)
#library(gridExtra)
library(ggpubr)
```

```{r Read in data}
d200813 <- read.csv(file = "data/200813_attune.csv", header = T, stringsAsFactors = F)
```

```{r Normalize the data}
d200813$norm_grn <- d200813$pct_grn / d200813[d200813$serum == "none","pct_grn"]
d200813$norm_red <- d200813$pct_red / d200813[d200813$serum == "none","pct_red"]
```


```{r Plot the data}
SARS2_pseudovirus_plot <- ggplot() + theme_bw() + theme(panel.grid.minor = element_blank()) +
  scale_x_log10() +  scale_y_log10(limits = c(8E-3,3)) + ggtitle("SARS CoV-2 pseudovirus") +
  labs(x = "Dilution of serum", y = "Fold infection of no-serum") + 
  geom_hline(yintercept = d200813[d200813$serum == "none","norm_grn"], linetype = 2) +
  geom_line(data = d200813 %>% filter(serum != "none"), aes(x = dilution, y = norm_grn, color = serum)) +
  geom_point(data = d200813 %>% filter(serum != "none"), aes(x = dilution, y = norm_grn, color = serum))

VSVG_pseudovirus_plot <- ggplot() + theme_bw() + theme(panel.grid.minor = element_blank()) +
  scale_x_log10() +  scale_y_log10(limits = c(8E-3,3)) + ggtitle("VSV-G pseudovirus") +
  labs(x = "Dilution of serum", y = "Fold infection of no-serum") + 
  geom_hline(yintercept = d200813[d200813$serum == "none","norm_red"], linetype = 2) +
  geom_line(data = d200813 %>% filter(serum != "none"), aes(x = dilution, y = norm_red, color = serum)) +
  geom_point(data = d200813 %>% filter(serum != "none"), aes(x = dilution, y = norm_red, color = serum))

arranged_plot <- ggarrange(SARS2_pseudovirus_plot, VSVG_pseudovirus_plot, ncol=2, nrow=1, common.legend = TRUE, legend="top")

ggsave(file = "plots/arranged_plot.pdf", arranged_plot, height = 3, width = 6)
```

